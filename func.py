#####################################################################################*
from scipy import interpolate


def FindApproximateWithinBounds(arr, x):
    min = 1000
    res = 0
    for i in range(len(arr)):
        if min > abs(arr[i] - x):
            min = abs(arr[i] - x)
            res = arr[i]
    return res


def FindMaxInBounds(arr, x, y):  # АЛГОРИТМ РАБОТАЕТ, НО ЕСТЬ НЬЮАНС!
    temp = [0]
    temp1 = arr.copy()
    temp2 = arr.copy()

    for i in range(len(arr)):
        temp1[i] = abs(temp1[i] - x)
        temp2[i] = abs(temp2[i] - y)
    for i in range(len(arr)):
        if min(temp1) == temp1[i]:
            index1 = i
        if min(temp2) == temp2[i]:
            index2 = i
    if min(temp1) < min(temp2):
        return arr[index1]
    elif min(temp2) < min(temp1):
        return arr[index2]
    else:
        return arr[index2]
    # if (x <= arr[i] <= y):
    # temp.append(arr[i])
    return max(temp)


def FindApproximateInInduction(arr, B_Z_1_shtrih, nu_0, k_px):
    min = 1000
    res = 0
    for i in range(len(arr)):
        if min > abs(round(round(B_Z_1_shtrih, 1) - (B_Z_1_shtrih - nu_0 * arr[i] * k_px), 1)):
            min = abs(round(round(B_Z_1_shtrih, 1) - (B_Z_1_shtrih - nu_0 * arr[i] * k_px), 1))
            res = arr[i]
    return res


def findTheNumberOfRotorSlots(P_2, Z_1, _2p):

    if _2p == 2:
        arr = {
            12: [9,15],
            18: [11, 12, 15, 21, 22],
            24: [15, 16, 17, 19, 32],
            30: [22, 38],
            36: [26, 28, 44, 46],
            42: [32, 33, 34, 50, 52],
            48: [38, 40, 56, 58]
        }[Z_1]

    elif _2p == 4:
        arr = {
            12: [9],
            18: [10, 14],
            24: [15, 16, 17],
            36: [26, 44, 46],
            42: [34, 50, 52, 54],
            48: [34, 38, 56, 58, 62, 64],
            60: [50, 52, 68, 70, 74],
            72: [62, 64, 80, 82, 86]
        }[Z_1]

    elif _2p == 6:
        arr = {
            36: [26, 46, 48],
            54: [44, 50, 64, 66, 68],
            72: [56, 58, 62, 82, 84, 86, 88],
            90: [74, 76, 78, 80, 100, 102, 104]
        }[Z_1]
    if (P_2 <= 250):
        temp_arr = [z_2 for z_2 in arr if z_2 < Z_1]
        return temp_arr[-1]
    else:
        temp_arr = [z_2 for z_2 in arr if z_2 > Z_1]
        return temp_arr[0]


#####################################################################################*
def SplineCubicInterpolate(x, x_meow, y_meow):
    return interpolate.interp1d(x_meow, y_meow, 'cubic')(x)


#####################################################################################*
def LinearInterpolation(x, x_meow, y_meow):
    for i in range(len(x_meow) - 1):
        if x_meow[i] <= x and x <= x_meow[i + 1]:
            return (x - x_meow[i]) * (y_meow[i] - y_meow[i + 1]) / (x_meow[i] - x_meow[i + 1]) + y_meow[i]
    return None


#####################################################################################*
def Lagrange(x, x_array, y_array):
    L = 0
    for i in range(len(x_array)):
        l = 1
        for j in range(len(x_array)):
            if (i != j):
                l *= (x - x_array[j]) / (x_array[i] - x_array[j])
        L += y_array[i] * l
    return L


#####################################################################################TODO
######! Рисунок 9.18
def big_p6_up(P_2):  # Большой график для 2р = 6
    x_meow = [0, 6.026803179, 12.68445349, 18.19039422, 31.96038763, 37.70820526, 44.44320252, 56.21469369, 75.88272771,
              85.9852236, 97.63331731, 106.0520639, 117.7801871, 137.0123062, 160]
    y_meow = [140, 160.8801783, 179.8683991, 194.0532096, 220.5684432, 230.2661744, 240.6865509, 256.3018091,
              280.4028142, 291.3051087, 304.2881388, 313.1426294, 324.5263782, 341.0103877, 360]
    if (P_2 < x_meow[0]):
        return None
    elif (P_2 > x_meow[-1]):
        return None
    return SplineCubicInterpolate(P_2, x_meow, y_meow)


def ppp_up(P_2):  # Большой график для 2р = 2,4
    x_meow = [0, 2.306624995, 4.354984513, 8.911753164, 12.4017533, 19.10481283, 24.62950765, 30.65889056, 33.99812196,
              45.74259646, 53.18173536, 58.11018766, 64.93349778, 72.38675702, 77.71012319, 83.49126151, 99.99474429,
              108.7028913, 120.2241735, 139.8318524, 158.5827459, 178.2364298, 198.4071001, 207.5752968, 219.2874312,
              238.3339407, 260, 320]
    y_meow = [120, 130.6816553, 138.3644414, 150.8895716, 159.5651062, 175.6004789, 185.9057522, 195.9954144,
              201.1368017, 217.2307644, 226.7195278, 232.5897745, 240.1844412, 248.1578336, 253.879496, 259.7788033,
              273.3829265, 280.2998244, 289.2692463, 303.1822558, 314.3209129, 325.1511524, 335.2553449, 339.5769413,
              344.6902055, 352.0551996, 360, 360]
    if (P_2 < x_meow[0]):
        return None
    elif (P_2 > x_meow[-1]):
        return None
    return SplineCubicInterpolate(P_2, x_meow, y_meow)


def ppp_down(P_2):  # Большой график для 2р = 2,4
    x_meow = [0, 5.146179369, 7.470704596, 10.51085676, 17.82732746, 22.13302387, 28.39418582, 33.88922758, 38.8554674,
              46.19443054, 58.6928849, 68.04974158, 78.24294995, 92.15659217, 102.2648801, 120.972167, 138.3882041,
              163.3433411, 179.4346191, 199.8210359, 220.1744025, 240.0246728, 274.3880779, 320]
    y_meow = [90, 120.2446036, 130.111185, 140.0687502, 160.3717342, 169.3406716, 181.2393804, 190.1707987, 196.8609206,
              205.6075573, 219.5548083, 228.629737, 238.0390546, 250.2927878, 258.2093148, 271.2124918, 282.6117278,
              297.8510423, 306.3589638, 315.8597342, 324.9656162, 332.8221126, 345.6414461, 360]
    if (P_2 < x_meow[0]):
        return None
    elif (P_2 > x_meow[-1]):
        return None
    return LinearInterpolation(P_2, x_meow, y_meow)


def p8_up(P_2):
    x_meow = [0.444, 2, 4, 6, 7.242]
    y_meow = [87.83, 112.3, 132.5, 149.4, 160]
    if (P_2 < x_meow[0]):
        return None
    elif (P_2 > x_meow[-1]):
        return None
    return Lagrange(P_2, x_meow, y_meow)
    # return -0.0178*(x**4) + 0.4271*(x**3) - 3.7528*(x**2) + 22.8*(x**1) + 78.58


def p8_down__p6_up(P_2):
    x_meow = [0.338, 2, 4, 6, 8, 10, 11]
    y_meow = [76.44, 100, 118.3, 132.75, 144.85, 156, 160]
    if (P_2 < x_meow[0]):
        return None
    elif (P_2 > x_meow[-1]):
        return big_p6_up(P_2)
    return Lagrange(P_2, x_meow, y_meow)
    # return -0.0081*(x**4) + 0.2277*(x**3) - 2.5008*(x**2) + 18.923*(x**1) + 70.349


def p6_down__p4_up(P_2):
    x_meow = [0.06, 0.12, 0.18, 0.25, 0.324, 2, 4, 6, 8, 10, 12, 14, 15.084]
    y_meow = [53, 56, 58, 63, 71.77, 92.7, 109.4, 121.9, 132.25, 141.77, 149.4, 156.35, 160]
    if (P_2 < x_meow[0]):
        return None
    elif (P_2 > x_meow[-1]):
        return ppp_up(P_2)
    return LinearInterpolation(P_2, x_meow, y_meow)
    # return -0.0022*(x**4) + 0.0907*(x**3) - 1.4506*(x**2) + 15.087*(x**1) + 67.207


def p2_up(P_2):
    x_meow = [0.312, 2, 4, 6, 8, 10, 12, 14, 15.084]
    y_meow = [66.7, 84.28, 98.75, 112.67, 125.75, 137.33, 146.67, 155.67, 160]
    if (P_2 < x_meow[0]):
        return None
    elif (P_2 > x_meow[-1]):
        return ppp_up(P_2)
    return Lagrange(P_2, x_meow, y_meow)
    # return -0.0012*(x**4) + 0.0417*(x**3) - 0.6714*(x**2) + 11.019*(x**1) + 63.669


def p4_down(P_2):
    x_meow = [0.06, 0.12, 0.18, 0.25, 0.312, 2, 4, 6, 8, 10, 12, 14, 16, 18, 18.712]
    y_meow = [53, 56, 58, 63, 66.7, 84.28, 98.75, 110.81, 121, 130.1, 137.7, 145.05, 151.73, 157, 160]
    if (P_2 < x_meow[0]):
        return None
    elif (P_2 > x_meow[-1]):
        return ppp_down(P_2)
    return LinearInterpolation(P_2, x_meow, y_meow)
    # return -0.0007*(x**4) + 0.037*(x**3) - 0.7797*(x**2) + 11.435*(x**1) + 63.526


def p2_down(P_2):
    x_meow = [0.312, 2, 4, 6, 8, 10, 12, 14, 16, 18, 18.712]
    y_meow = [60, 75, 90, 104.25, 117.32, 128.12, 136.78, 145.05, 151.73, 157, 160]
    if (P_2 < x_meow[0]):
        return None
    elif (P_2 > x_meow[-1]):
        return ppp_down(P_2)
    return Lagrange(P_2, x_meow, y_meow)


#####################################################################################TODO
######! Рисунок 9.21 (а)
def kpd_func_b(_2p, P_2):
    x_temp = {
        2: [25, 42.47706543, 51.04432759, 75.73396386, 101.4960419, 127.0057492, 151.8090323, 174.9534988,
            201.1029363, 226.2893106, 250.2010264, 275.004843, 300.4190444, 325.2570084, 350],
        4: [0.06, 0.09, 0.12, 0.18, 0.25, 0.37, 0.56, 0.75, 1.1, 1.5, 2.2, 3, 4, 5.5, 7.5, 11, 15, 18.5, 22, 30, 37, 45,
            55, 75, 90, 110, 132, 160,
            200, 250, 315],
        6: [25, 38.48188765, 51.57302681, 65.0543821, 76.49415638, 90.00106471, 101.9114407, 127.1093948,
            152.242934, 175.0671177, 201.2946461, 215, 226.8684428, 250, 275.2360789, 300.5612659, 325.2486916, 350],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    y_temp = {
        2: [0.89, 0.9029402213, 0.9075621638, 0.9133390845, 0.9165, 0.918, 0.9188, 0.9195, 0.921, 0.9222165838,
            0.9237978281, 0.9252, 0.926590886, 0.9284197706, 0.93],
        4: [0.5, 0.55, 0.63, 0.64, 0.68, 0.68, 0.705, 0.72, 0.75, 0.77, 0.8, 0.82, 0.84, 0.855, 0.875, 0.875, 0.885,
            0.895, 0.9, 0.905,
            0.91, 0.92, 0.92, 0.93, 0.93, 0.925, 0.93, 0.935, 0.94, 0.945, 0.945],
        6: [0.89, 0.9064996745, 0.914998685, 0.9203414261, 0.9243494654, 0.9274722936, 0.9301830068,
            0.9331297764, 0.9345441471, 0.93518664, 0.9360765459, 0.9365694, 0.937011919, 0.938373,
            0.9399655735, 0.9417330451, 0.9435015003, 0.945387],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    # for i in range(len(x_temp)):
    #     if (x_temp[i][0] <= P_2 <= x_temp[i][-1]):
    #         x_meow = x_temp[i]
    #         y_meow = y_temp[i]
    #         break
    x_meow = x_temp
    y_meow = y_temp
    if (P_2 < x_temp[0]):
        return None
    elif (P_2 > x_temp[-1]):
        return None
    else:
        return SplineCubicInterpolate(P_2, x_meow, y_meow)

def kpd_func(_2p, P_2):
    x_temp = {
        2: [0.25, 0.304202532, 0.379932915, 0.41618139, 0.548199017, 0.760031362, 1.006580556, 1.200161028,
            1.480448533, 1.793836172, 2.043576253, 2.552714167, 2.867207979, 3.329758944, 3.676289261, 4.000057919,
            4.332633424, 4.903206546, 5.484415959, 5.683229485, 7.086198637, 7.413115636, 7.920509198, 9.826872666,
            10.20892819, 10.91466728, 11.34165049, 11.71766461, 12.33261233, 13.99391568, 14.45940227, 15.9512908,
            18.53127176, 19.89773717, 20.85615196, 21.23739913, 21.85953698, 22.28383985, 23.61380151, 24.15931553,
            24.77285926, 26.4435651, 28.0038237, 29.04554191, 29.63611126, 30],
        4: [0.06, 0.09, 0.12, 0.18, 0.25, 0.37, 0.56, 0.75, 1.1, 1.5, 2.2, 3, 4, 5.5, 7.5, 11, 15, 18.5, 22, 30, 37, 45,
            55, 75, 90, 110, 132, 160,
            200, 250, 315],
        6: [0, 0.06592599, 0.255244242, 0.365733297, 0.659088999, 0.892414879, 1.083527617, 1.628538591, 1.802347358,
            2.123987575, 2.693437736, 3.074082356, 3.444002786, 4.218665216, 4.417724962, 4.589525615, 4.908132296,
            5.592643178, 6.008365722, 6.794222325, 7.194435385, 7.722526921, 8.010840973, 8.475740973, 9.352988175,
            10.57409304, 11.52901584, 12.11243735, 12.97413234, 13.63651123, 14.08470543, 14.78365765, 16.92755547,
            17.6159544, 18.93225246, 19.49623372, 20.14874293, 21.0231275, 21.55373987, 23.00257352, 24.36975807,
            24.77514096, 26.10212048, 26.83367253, 28.80764964, 29.65332243, 30],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    y_temp = {
        2: [0.725, 0.7308138153, 0.745967127, 0.7509045678, 0.7612256036, 0.7749714048, 0.788358158, 0.7969806207,
            0.8078933421, 0.8184640119, 0.8254420775, 0.8382764491, 0.8449677012, 0.8529942293, 0.8577574574,
            0.8613256295, 0.8643616032, 0.8684417904, 0.8718824897, 0.8727238093, 0.8779278803, 0.8787405185,
            0.8789359766, 0.8820101921, 0.8820654302, 0.8831266401, 0.8830384715, 0.883458069, 0.8848623927,
            0.8873194281, 0.8874755821, 0.8898858775, 0.8933945623, 0.8956699492, 0.8968894376, 0.8969946025,
            0.8979655192, 0.8980398783, 0.8999509058, 0.9004108696, 0.9019022997, 0.903793144, 0.9072094112,
            0.9085393758, 0.9088516838, 0.91],
        4: [0.5, 0.55, 0.63, 0.64, 0.68, 0.68, 0.705, 0.72, 0.75, 0.77, 0.8, 0.82, 0.84, 0.855, 0.875, 0.875, 0.885,
            0.895, 0.9, 0.905,
            0.91, 0.92, 0.92, 0.93, 0.93, 0.925, 0.93, 0.935, 0.94, 0.945, 0.945],
        6: [0.61, 0.6292441863, 0.6581237268, 0.6702079795, 0.6958109029, 0.7121077913, 0.723327857, 0.7517620428,
            0.7598513642, 0.7718836773, 0.7912129562, 0.801559994, 0.8105676523, 0.8262567365, 0.8298416762,
            0.8324596547, 0.8365871978, 0.8445593788, 0.8479619772, 0.8522751769, 0.8539770287, 0.8557020875,
            0.8563828282, 0.8567132527, 0.8579885364, 0.8608021174, 0.8630454674, 0.8645196689, 0.8666878723,
            0.8681112392, 0.8693876281, 0.8712176713, 0.8761430955, 0.8785345288, 0.8817536809, 0.883907518,
            0.885870173, 0.8873244827, 0.8886914896, 0.8918432307, 0.8947938439, 0.8959354107, 0.8984937138,
            0.9008530992, 0.9057420553, 0.9086363084, 0.91],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    # for i in range(len(x_temp)):
    #     if (x_temp[i][0] <= P_2 <= x_temp[i][-1]):
    #         x_meow = x_temp[i]
    #         y_meow = y_temp[i]
    #         break
    x_meow = x_temp
    y_meow = y_temp
    if (P_2 < x_temp[0]):
        return None
    elif (P_2 > x_temp[-1]):
        return kpd_func_b(_2p, P_2)
    else:
        return SplineCubicInterpolate(P_2, x_meow, y_meow)


def cosPhi_func(_2p, P_2):
    x_meow = {
        2: [0.2, 0.561109901, 0.783147442, 0.94860811, 1.293876487, 1.981595071, 2.662353632, 3.633554377, 4.551423413,
            5.439317381, 7.699147156, 9.005923485, 10.35565554, 11.61862215, 12.92676487, 14.36198137, 16.80580341,
            18.28329245, 19.67504084, 20.38338329, 20.93933114, 21.9897395, 23.04040407, 24.47562058, 25.99657773,
            27.47329818, 28.52362115, 29.18998997, 30],
        4:
            [0.06, 0.09, 0.12, 0.18, 0.25, 0.37, 0.56, 0.75, 1.1, 1.5, 2.2, 3, 4, 5.5, 7.5, 11, 15, 18.5, 22, 30, 37,
             45, 55, 75, 90, 110, 132,
             160, 200, 250, 315],
        6: [0.5, 0.5659358, 0.699252801, 0.93153727, 1.150473034, 1.619165616, 2.039054653, 2.223513348, 2.481432431,
            2.84699139, 3.069753215, 3.63163166, 4.206178622, 4.659439421, 5.886202399, 6.748256656, 7.581615448,
            8.898503441, 9.493498577, 10.31775984, 11.5112786, 13.6518752, 15.44931657, 16.59739021, 17.22550204,
            18.78003098, 19.47293079, 19.81795655, 20.47340347, 24.71025687, 26.83788738, 27.71388551, 28.50532767,
            30],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    y_meow = {
        2: [0.848, 0.858275696, 0.863500444, 0.866764263, 0.872324621, 0.880736477, 0.886725938, 0.893303918,
            0.897700425, 0.90123513, 0.904459395, 0.905669993, 0.906861412, 0.908145125, 0.909262231, 0.910453651,
            0.912790943, 0.914013527, 0.915255289, 0.916479071, 0.916446708, 0.917658505, 0.918848726, 0.920038947,
            0.921211189, 0.922486512, 0.923703102, 0.924875344, 0.925],
        4:
            [0.6, 0.6, 0.66, 0.64, 0.65, 0.69, 0.7, 0.73, 0.81, 0.83, 0.83, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88, 0.88,
             0.9, 0.9, 0.9, 0.9, 0.9,
             0.9, 0.91, 0.9, 0.9, 0.9, 0.92, 0.92, 0.92],
        6: [0.675, 0.683128028, 0.693846111, 0.707918567, 0.718818893, 0.738080297, 0.752343831, 0.758091658,
            0.76528859, 0.77445485, 0.779152295, 0.789249649, 0.798555075, 0.804799927, 0.818534405, 0.825809757,
            0.832216971, 0.840299714, 0.842988071, 0.847298941, 0.852450337, 0.85954676, 0.864159159, 0.866828739,
            0.867439529, 0.869102908, 0.870498998, 0.871106474, 0.87175813, 0.878060416, 0.880633905, 0.882089638,
            0.882732458, 0.885],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    if (P_2 < x_meow[0]):
        return None
    elif (P_2 > x_meow[-1]):
        return cosPhi_func_b(_2p, P_2)
    else:
        return SplineCubicInterpolate(P_2, x_meow, y_meow)

def cosPhi_func_b(_2p, P_2):
    x_meow = {
        2: [19.5, 24.5, 31.38635662, 37.87063157, 44.13453082, 66.58243758, 78.60652017, 171.9871229, 255.8344755,
            309.9385784, 337.3782884, 350],
        4:
            [0.06, 0.09, 0.12, 0.18, 0.25, 0.37, 0.56, 0.75, 1.1, 1.5, 2.2, 3, 4, 5.5, 7.5, 11, 15, 18.5, 22, 30, 37,
             45, 55, 75, 90, 110, 132,
             160, 200, 250, 315],
        6: [12, 26.04425498, 38.00356219, 51.80190299, 76.59239498, 102.4985496, 152.3605784, 198.9096853, 237.2105537,
            264.6800199, 284.0912722, 307.2444654, 325.5922186, 350],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    y_meow = {
        2: [0.89, 0.8958, 0.9012539885, 0.9045405233, 0.9055599872, 0.9055647735, 0.9047, 0.9035912572, 0.9046506063,
            0.908, 0.9086375239, 0.91],
        4:
            [0.6, 0.6, 0.66, 0.64, 0.65, 0.69, 0.7, 0.73, 0.81, 0.83, 0.83, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88, 0.88,
             0.9, 0.9, 0.9, 0.9, 0.9,
             0.9, 0.91, 0.9, 0.9, 0.9, 0.92, 0.92, 0.92],
        6: [0.86, 0.878971529, 0.888095343, 0.894111675, 0.897813948, 0.899202163, 0.901351799, 0.903118517,
            0.904784816, 0.90616972, 0.906973074, 0.908152726, 0.909000221, 0.91],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    if (P_2 < x_meow[0]):
        return None
    elif (P_2 > x_meow[-1]):
        return None
    else:
        return SplineCubicInterpolate(P_2, x_meow, y_meow)



#####################################################################################TODO
######! Рисунок 9.22
def B_del__up(_2p, D_a):
    x_temp = {
        2: [
            # а)
            [0.09, 0.094949641, 0.099613454, 0.107393478, 0.114942085, 0.121991699, 0.129364676, 0.139686501,
             0.150796935, 0.160818812, 0.172349723, 0.182688766, 0.19359361, 0.203508044, 0.213808518, 0.224713362,
             0.24472268, 0.26],
            # б)
            [0.27, 0.485],
            # в)
            [0.5, 0.511856015, 0.524555374, 0.547663126, 0.572484035, 0.59739511, 0.623411339, 0.648729402, 0.674273708,
             0.698506469, 0.725]
        ],
        4: [
            # а)
            [0.08, 0.104935964, 0.117681049, 0.127742923, 0.13696384, 0.147022055, 0.157903929, 0.168052626,
             0.17908353, 0.18951798, 0.199505339, 0.209492698, 0.219778118, 0.230771764, 0.240046905, 0.250426466,
             0.26],
            # б)
            [0.27, 0.49],
            # в)
            [0.5, 0.524281985, 0.547397844, 0.572520052, 0.597743302, 0.623836176, 0.649134793, 0.674423057,
             0.699349392, 0.725]
        ],
        6: [
            # а)
            [0.088, 0.104935964, 0.117681049, 0.127742923, 0.13696384, 0.147022055, 0.157903929, 0.168052626,
             0.17908353, 0.18951798, 0.199505339, 0.209492698, 0.219778118, 0.230771764, 0.240046905, 0.250426466,
             0.26, 0.28],
            # б)
            [0.27, 0.486],
            # в)
            [0.5, 0.513422833, 0.525202807, 0.548093396, 0.572985093, 0.597324251, 0.623759202, 0.67387502, 0.725]
        ],
        8: [
            # а)
            [0.088, 0.104935964, 0.117681049, 0.127742923, 0.13696384, 0.147022055, 0.157903929, 0.168052626,
             0.17908353, 0.18951798, 0.199505339, 0.209492698, 0.219778118, 0.230771764, 0.240046905, 0.250426466,
             0.26],
            # б)
            [0.27, 0.485],
            # в)
            [0.5, 0.513422833, 0.525202807, 0.548093396, 0.572985093, 0.597324251, 0.623759202, 0.67387502, 0.725]
        ],
        10: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [0.5, 0.513422833, 0.525202807, 0.548093396, 0.572985093, 0.597324251, 0.623759202, 0.67387502, 0.725]
        ],
        12: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [0.5, 0.513422833, 0.525202807, 0.548093396, 0.572985093, 0.597324251, 0.623759202, 0.67387502, 0.725]
        ],
    }[_2p]

    y_temp = {
        2: [
            # а)
            [0.675, 0.681455902, 0.687153595, 0.695322222, 0.701794814, 0.707169831, 0.712947795, 0.720070507,
             0.72564978, 0.730022594, 0.734315932, 0.737283596, 0.739539148, 0.741230415, 0.742626028, 0.743812616,
             0.744643944, 0.745],
            # б)
            [0.745, 0.761],
            # в)
            [0.7475, 0.749661677, 0.751539615, 0.753868289, 0.755827406, 0.756779518, 0.757760623, 0.758436727,
             0.759154967, 0.759662141, 0.76]
        ],
        4: [
            # а)
            [0.81, 0.835537404, 0.852577079, 0.863805684, 0.873906741, 0.88216658, 0.890223902, 0.896531093, 0.9024757,
             0.906438477, 0.910136833, 0.913175463, 0.91581702, 0.917270008, 0.918502794, 0.919207621, 0.92],
            # б)
            [0.77, 0.79],
            # в)
            [0.78, 0.783648841, 0.786347683, 0.78848159, 0.789691194, 0.790781009, 0.791508434, 0.791893875,
             0.792279694, 0.7925]
        ],
        6: [
            # а)
            [0.81, 0.835537404, 0.852577079, 0.863805684, 0.873906741, 0.88216658, 0.890223902, 0.896531093, 0.9024757,
             0.906438477, 0.910136833, 0.913175463, 0.91581702, 0.917270008, 0.918502794, 0.919207621, 0.92, 0.925],
            # б)
            [0.795, 0.819],
            # в)
            [0.8125, 0.81444472, 0.815803723, 0.818081823, 0.819938774, 0.820510334, 0.820897155, 0.820815756, 0.82]
        ],
        8: [
            # а)
            [0.81, 0.835537404, 0.852577079, 0.863805684, 0.873906741, 0.88216658, 0.890223902, 0.896531093, 0.9024757,
             0.906438477, 0.910136833, 0.913175463, 0.91581702, 0.917270008, 0.918502794, 0.919207621, 0.92],
            # б)
            [0.795, 0.819],
            # в)
            [0.8125, 0.81444472, 0.815803723, 0.818081823, 0.819938774, 0.820510334, 0.820897155, 0.820815756, 0.82]
        ],
        10: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [0.8125, 0.81444472, 0.815803723, 0.818081823, 0.819938774, 0.820510334, 0.820897155, 0.820815756, 0.82]
        ],
        12: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [0.8125, 0.81444472, 0.815803723, 0.818081823, 0.819938774, 0.820510334, 0.820897155, 0.820815756, 0.82]
        ],
    }[_2p]

    for i in range(len(x_temp)):
        if (x_temp[i][0] <= D_a <= x_temp[i][-1]):
            x_meow = x_temp[i]
            y_meow = y_temp[i]
            break

    if (D_a < x_temp[0][0]):
        return None
    elif (D_a > x_temp[-1][-1]):
        return None
    else:
        return LinearInterpolation(D_a, x_meow, y_meow)


def B_del__down(_2p, D_a):
    x_temp = {
        2: [
            # а)
            [0.09, 0.096358858, 0.100987574, 0.109590912, 0.120320812, 0.130041855, 0.140111278, 0.150757863,
             0.16128653, 0.172678251, 0.181581592, 0.191955722, 0.20215079, 0.212086169, 0.222992107, 0.243139352,
             0.26],
            # б)
            [0.26, 0.27, 0.485],
            # в)
            [0.5, 0.512930417, 0.52458246, 0.536505962, 0.547254797, 0.560984714, 0.572637171, 0.597386968, 0.607090462,
             0.623491991, 0.648652074, 0.673492358, 0.725]
        ],
        4: [
            # а)
            [0.08, 0.098866009, 0.107648122, 0.117959209, 0.127592514, 0.137657195, 0.147142194, 0.157835773,
             0.168110197, 0.178865543, 0.189411477, 0.198883924, 0.20982457, 0.21950676, 0.230323872, 0.239278403,
             0.250305259, 0.26],
            # б)
            [0.27, 0.49],
            # в)
            [0.5, 0.524447331, 0.547976261, 0.572949687, 0.598734071, 0.621870695, 0.648594063, 0.67361277, 0.698361433,
             0.725]
        ],
        6: [
            # а)
            [0.088, 0.098866009, 0.107648122, 0.117959209, 0.127592514, 0.137657195, 0.147142194, 0.157835773,
             0.168110197, 0.178865543, 0.189411477, 0.198883924, 0.20982457, 0.21950676, 0.230323872, 0.239278403,
             0.250305259, 0.26,0.28],
            # б)
            [0.27, 0.485],
            # в)
            [0.5, 0.512846467, 0.524674956, 0.548211637, 0.572784012, 0.597761766, 0.623745551, 0.649158345,
             0.674096961, 0.698800343, 0.725]
        ],
        8: [
            # а)
            [0.088, 0.098866009, 0.107648122, 0.117959209, 0.127592514, 0.137657195, 0.147142194, 0.157835773,
             0.168110197, 0.178865543, 0.189411477, 0.198883924, 0.20982457, 0.21950676, 0.230323872, 0.239278403,
             0.250305259, 0.26],
            # б)
            [0.27, 0.485],
            # в)
            [0.5, 0.512846467, 0.524674956, 0.548211637, 0.572784012, 0.597761766, 0.623745551, 0.649158345,
             0.674096961, 0.698800343, 0.725]
        ],
        10: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [0.5, 0.512846467, 0.524674956, 0.548211637, 0.572784012, 0.597761766, 0.623745551, 0.649158345,
             0.674096961, 0.698800343, 0.725]
        ],
        12: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [0.5, 0.512846467, 0.524674956, 0.548211637, 0.572784012, 0.597761766, 0.623745551, 0.649158345,
             0.674096961, 0.698800343, 0.725]
        ],
    }[_2p]

    y_temp = {
        2: [
            # а)
            [0.64, 0.648771846, 0.654521002, 0.664316636, 0.674664444, 0.682431803, 0.689701535, 0.69590636,
             0.701470058, 0.705912626, 0.708904267, 0.711281637, 0.713015362, 0.713935093, 0.714436078, 0.715, 0.715],
            # б)
            [0.715, 0.735, 0.751],
            # в)
            [0.735, 0.737305642, 0.739132251, 0.740350123, 0.741219862, 0.742350601, 0.743046471, 0.743916209,
             0.744220578, 0.744644704, 0.744960213, 0.744960213, 0.745]
        ],
        4: [
            # а)
            [0.77, 0.785244266, 0.79920699, 0.813408606, 0.823403667, 0.833308444, 0.841572946, 0.849419588,
             0.856132498, 0.862219018, 0.866484696, 0.869468833, 0.872839669, 0.875316463, 0.877136507, 0.878031349,
             0.879284127, 0.88],
            # б)
            [0.76, 0.78],
            # в)
            [0.7675, 0.770684779, 0.772913429, 0.774557559, 0.77590447, 0.776608672, 0.777096324, 0.777313205,
             0.777313205, 0.7775]
        ],
        6: [
            # а)
            [0.77, 0.785244266, 0.79920699, 0.813408606, 0.823403667, 0.833308444, 0.841572946, 0.849419588,
             0.856132498, 0.862219018, 0.866484696, 0.869468833, 0.872839669, 0.875316463, 0.877136507, 0.878031349,
             0.879284127, 0.88, 0.885],
            # б)
            [0.788, 0.808],
            # в)
            [0.7975, 0.799909034, 0.80191918, 0.804935166, 0.807266798, 0.808606768, 0.809709935, 0.810059009,
             0.810045598, 0.81002414, 0.81]
        ],
        8: [
            # а)
            [0.77, 0.785244266, 0.79920699, 0.813408606, 0.823403667, 0.833308444, 0.841572946, 0.849419588,
             0.856132498, 0.862219018, 0.866484696, 0.869468833, 0.872839669, 0.875316463, 0.877136507, 0.878031349,
             0.879284127, 0.88],
            # б)
            [0.788, 0.808],
            # в)
            [0.7975, 0.799909034, 0.80191918, 0.804935166, 0.807266798, 0.808606768, 0.809709935, 0.810059009,
             0.810045598, 0.81002414, 0.81]
        ],
        10: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [0.7975, 0.799909034, 0.80191918, 0.804935166, 0.807266798, 0.808606768, 0.809709935, 0.810059009,
             0.810045598, 0.81002414, 0.81]
        ],
        12: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [0.7975, 0.799909034, 0.80191918, 0.804935166, 0.807266798, 0.808606768, 0.809709935, 0.810059009,
             0.810045598, 0.81002414, 0.81]
        ],
    }[_2p]

    for i in range(len(x_temp)):
        if (x_temp[i][0] <= D_a <= x_temp[i][-1]):
            x_meow = x_temp[i]
            y_meow = y_temp[i]
            break

    if (D_a < x_temp[0][0]):
        return None
    elif (D_a > x_temp[-1][-1]):
        return None
    else:
        return LinearInterpolation(D_a, x_meow, y_meow)


def A__up(_2p, D_a):
    x_temp = {
        2: [
            # а)
            [0.095, 0.103077256, 0.112451388, 0.121148777, 0.131452947, 0.140585108, 0.152471797, 0.160347841,
             0.171473356, 0.180847165, 0.191948418, 0.20069433, 0.211711152, 0.221447918, 0.231558317, 0.240473091,
             0.26],
            # б)
            [0.26,0.27, 0.281776372, 0.292254085, 0.301154414, 0.312008768, 0.32193425, 0.332421755, 0.341704598,
             0.350103284, 0.362042845, 0.373076053, 0.385810345, 0.400760743, 0.4109705, 0.420915238, 0.431708233,
             0.441314191, 0.452717839, 0.461504588, 0.481412015, 0.49],
            # в)
            [0.49,0.5, 0.513023191, 0.524780272, 0.535959643, 0.547588755, 0.561078559, 0.572505226, 0.585327205,
             0.597090459, 0.611025067, 0.623245881, 0.637014254, 0.648589051, 0.662707589, 0.673958968, 0.686040703,
             0.698189509, 0.725]
        ],
        4: [
            # а)
            [0.08, 0.097190855, 0.101793572, 0.1079556, 0.114117296, 0.120873095, 0.130078529, 0.140318423,
             0.149807488, 0.161411199, 0.172435719, 0.182433068, 0.191873757, 0.202415838, 0.222620941, 0.233954937,
             0.243011928, 0.26],
            # б)
            [0.26, 0.27, 0.275904081, 0.280521776, 0.290551871, 0.299687882, 0.310313925, 0.32035575, 0.330584602,
             0.340155274, 0.350582558, 0.360252609, 0.370928178, 0.379226474, 0.389206717, 0.399755211, 0.410109509,
             0.419112255, 0.42983735, 0.439887647, 0.449480149, 0.459764068, 0.470652079, 0.479982287, 0.49],
            # в)
            [0.49, 0.5, 0.512243148, 0.524327085, 0.536951513, 0.547628187, 0.560225736, 0.572374597, 0.584657445,
             0.597300069, 0.612189848, 0.623335471, 0.636158397, 0.649198016, 0.674411308, 0.688532737, 0.699137456,
             0.725]
        ],
        6: [
            # а)
            [0.088, 0.097190855, 0.101793572, 0.1079556, 0.114117296, 0.120873095, 0.130078529, 0.140318423,
             0.149807488, 0.161411199, 0.172435719, 0.182433068, 0.191873757, 0.202415838, 0.222620941, 0.233954937,
             0.243011928, 0.26],
            # б)
            [0.26,0.27, 0.277702913, 0.289960569, 0.297428832, 0.30904469, 0.318515125, 0.328717098, 0.338957292,
             0.349840283, 0.359086371, 0.369567531, 0.378534432, 0.389163828, 0.398794796, 0.409132041, 0.419198741,
             0.429925187, 0.440245815, 0.451031422, 0.460514487, 0.475309758, 0.49],
            # в)
            [0.49, 0.5, 0.509958987, 0.524700023, 0.536600414, 0.54786262, 0.562828363, 0.580564531, 0.596992523, 0.611724884,
             0.623229972, 0.636963957, 0.648576855, 0.661829206, 0.674418589, 0.698632848, 0.725]
        ],
        8: [
            # а)
            [0.088, 0.097190855, 0.101793572, 0.1079556, 0.114117296, 0.120873095, 0.130078529, 0.140318423,
             0.149807488, 0.161411199, 0.172435719, 0.182433068, 0.191873757, 0.202415838, 0.222620941, 0.233954937,
             0.243011928, 0.26],
            # б)
            [0.27, 0.277702913, 0.289960569, 0.297428832, 0.30904469, 0.318515125, 0.328717098, 0.338957292,
             0.349840283, 0.359086371, 0.369567531, 0.378534432, 0.389163828, 0.398794796, 0.409132041, 0.419198741,
             0.429925187, 0.440245815, 0.451031422, 0.460514487, 0.475309758, 0.49],
            # в)
            [0.5, 0.509958987, 0.524700023, 0.536600414, 0.54786262, 0.562828363, 0.580564531, 0.596992523, 0.611724884,
             0.623229972, 0.636963957, 0.648576855, 0.661829206, 0.674418589, 0.698632848, 0.725]
        ],
        10: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [0.5, 0.511954878, 0.524217216, 0.535073195, 0.547453213, 0.56075271, 0.572041702, 0.58551689, 0.596986131,
             0.610889773, 0.623116476, 0.637385175, 0.648475685, 0.663501845, 0.674213625, 0.687887709, 0.698815788,
             0.712319567, 0.725]
        ],
        12: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [0.5, 0.511954878, 0.524217216, 0.535073195, 0.547453213, 0.56075271, 0.572041702, 0.58551689, 0.596986131,
             0.610889773, 0.623116476, 0.637385175, 0.648475685, 0.663501845, 0.674213625, 0.687887709, 0.698815788,
             0.712319567, 0.725]
        ],
    }[_2p]

    y_temp = {
        2: [
            # а)
            [17, 17.99208634, 19.05040021, 19.92510822, 20.83724918, 21.59114939, 22.48999308, 22.98775098, 23.59301942,
             24.07628298, 24.5728438, 24.94976156, 25.37986839, 25.75678614, 26.10597698, 26.41042299, 27],
            # б)
            [27,36.5, 37.1213195, 37.6730654, 38.0979926, 38.5743272, 38.997606, 39.435033, 39.8049813, 40.1278147,
             40.558408, 40.8965228, 41.2617665, 41.6305472, 41.8631342, 42.0788258, 42.316083, 42.5252499, 42.7662847,
             42.951173, 43.3353725, 43.5],
            # в)
            [43.5, 49, 49.27539561, 49.50288048, 49.72165099, 49.91755998, 50.14821702, 50.33628674, 50.50404725, 50.65747831,
             50.83796398, 50.98585284, 51.14369576, 51.27247867, 51.42751404, 51.54200394, 51.66447896, 51.78053672, 52]
        ],
        4: [
            # а)
            [17.5, 18.49535144, 19.11137152, 19.8758645, 20.59580236, 21.30089956, 22.24533559, 23.17456657,
             23.91252524, 24.72584665, 25.3902314, 25.93946849, 26.4305686, 26.93031473, 27.74303987, 28.17845436,
             28.51492005, 29.1],
            # б)
            [29.1, 33.5, 33.8150861, 34.0371748, 34.5278171, 34.951321, 35.4109529, 35.8331689, 36.2308477, 36.5911107,
             36.9319541, 37.240567, 37.5607706, 37.7847912, 38.0636815, 38.3299982, 38.5714049, 38.7872916, 39.0111088,
             39.2260126, 39.427021, 39.6427721, 39.861709, 40.0532279, 40.25],
            # в)
            [40.25, 44, 44.29980059, 44.58168878, 44.85157808, 45.06150725, 45.28866121, 45.49951867, 45.65450732, 45.80746751,
             45.97820257, 46.08615829, 46.18063673, 46.25259575, 46.35604758, 46.41452933, 46.44602214, 46.5]
        ],
        6: [
            # а)
            [17.5, 18.49535144, 19.11137152, 19.8758645, 20.59580236, 21.30089956, 22.24533559, 23.17456657,
             23.91252524, 24.72584665, 25.3902314, 25.93946849, 26.4305686, 26.93031473, 27.74303987, 28.17845436,
             28.51492005, 29.1],
            # б)
            [29.1, 31.25, 31.7169427, 32.3872895, 32.7679715, 33.2952526, 33.6765801, 34.0501615, 34.4042416, 34.6902372,
             34.91919, 35.1691049, 35.359327, 35.5647016, 35.7493179, 35.9291778, 36.1038397, 36.2698721, 36.4255083,
             36.5854933, 36.7247199, 36.9266292, 37.1],
            # в)
            [37.1, 40.1, 40.3204814, 40.64203876, 40.87476326, 41.09140989, 41.30038699, 41.5285731, 41.71897446, 41.86691196,
             41.97101352, 42.07666305, 42.15321763, 42.23554194, 42.30710077, 42.41732387, 42.5]
        ],
        8: [
            # а)
            [17.5, 18.49535144, 19.11137152, 19.8758645, 20.59580236, 21.30089956, 22.24533559, 23.17456657,
             23.91252524, 24.72584665, 25.3902314, 25.93946849, 26.4305686, 26.93031473, 27.74303987, 28.17845436,
             28.51492005, 29.1],
            # б)
            [31.25, 31.7169427, 32.3872895, 32.7679715, 33.2952526, 33.6765801, 34.0501615, 34.4042416, 34.6902372,
             34.91919, 35.1691049, 35.359327, 35.5647016, 35.7493179, 35.9291778, 36.1038397, 36.2698721, 36.4255083,
             36.5854933, 36.7247199, 36.9266292, 37.1],
            # в)
            [40.1, 40.3204814, 40.64203876, 40.87476326, 41.09140989, 41.30038699, 41.5285731, 41.71897446, 41.86691196,
             41.97101352, 42.07666305, 42.15321763, 42.23554194, 42.30710077, 42.41732387, 42.5]
        ],
        10: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [37, 37.22496146, 37.46044829, 37.64434594, 37.85481647, 38.03949241, 38.19110976, 38.34958343, 38.48507916,
             38.63506582, 38.75603356, 38.88304228, 38.97013609, 39.0802449, 39.15762868, 39.25806452, 39.33548535,
             39.42061492, 39.5]
        ],
        12: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [37, 37.22496146, 37.46044829, 37.64434594, 37.85481647, 38.03949241, 38.19110976, 38.34958343, 38.48507916,
             38.63506582, 38.75603356, 38.88304228, 38.97013609, 39.0802449, 39.15762868, 39.25806452, 39.33548535,
             39.42061492, 39.5]
        ],
    }[_2p]

    for i in range(len(x_temp)):
        if (x_temp[i][0] <= D_a <= x_temp[i][-1]):
            x_meow = x_temp[i]
            y_meow = y_temp[i]
            break

    if (D_a < x_temp[0][0]):
        return None
    elif (D_a > x_temp[-1][-1]):
        return None
    else:
        return LinearInterpolation(D_a, x_meow, y_meow) * 1000


def A__down(_2p, D_a):
    x_temp = {
        2: [
            # а)
            [0.095, 0.103843368, 0.110698511, 0.120086758, 0.129983892, 0.136799378, 0.14706543, 0.157347812,
             0.168300711, 0.178266496, 0.188865474, 0.201126416, 0.214463786, 0.226981671, 0.239573872, 0.26],
            # б)
            [0.26, 0.27, 0.275687648, 0.281793342, 0.292253632, 0.300911301, 0.312233118, 0.321939816, 0.333389786,
             0.341489516, 0.35252144, 0.361466067, 0.37236136, 0.38070957, 0.392002366, 0.40054949, 0.410190644,
             0.42051365, 0.432390145, 0.441235641, 0.451537777, 0.461526216, 0.472110746, 0.481104938, 0.49],
            # в)
            [0.49, 0.5, 0.523461789, 0.535522724, 0.54721102, 0.559456826, 0.572098433, 0.584183356, 0.596835715, 0.610010432,
             0.622904738, 0.636196085, 0.648371169, 0.673661826, 0.698215064, 0.725]
        ],
        4: [
            # а)
            [0.08, 0.097260563, 0.10573, 0.113930392, 0.122424772, 0.130993646, 0.142472798, 0.154841562, 0.165958551,
             0.178774615, 0.18922481, 0.198464136, 0.209938965, 0.219402107, 0.239371315, 0.25017536, 0.26],
            # б)
            [0.26, 0.27, 0.279946384, 0.289162773, 0.299031987, 0.30997764, 0.320238615, 0.329837242, 0.340019076,
             0.350861617, 0.360172252, 0.370887051, 0.379458169, 0.389933577, 0.399386074, 0.409897276, 0.419653198,
             0.430061945, 0.440365281, 0.450907351, 0.460565415, 0.470929831, 0.480641749, 0.49],
            # в)
            [0.49,0.5, 0.524156092, 0.53740773, 0.547275442, 0.55993116, 0.572140665, 0.584728788, 0.596937878, 0.611082773,
             0.62342747, 0.648806917, 0.674254375, 0.698903127, 0.725]
        ],
        6: [
            # а)
            [0.088, 0.097260563, 0.10573, 0.113930392, 0.122424772, 0.130993646, 0.142472798, 0.154841562, 0.165958551,
             0.178774615, 0.18922481, 0.198464136, 0.209938965, 0.219402107, 0.239371315, 0.25017536, 0.26],
            # б)
            [0.26, 0.27, 0.284079299, 0.293580568, 0.305666219, 0.314773107, 0.325965966, 0.334780497, 0.345655576,
             0.355596718, 0.375263917, 0.385931603, 0.395577712, 0.406032654, 0.416083179, 0.426878646, 0.437291106,
             0.447711928, 0.457505554, 0.46851109, 0.47843651, 0.49],
            # в)
            [0.49, 0.5, 0.512227141, 0.523894911, 0.536894911, 0.547722383, 0.561128672, 0.571997518, 0.585461316,
             0.597057096, 0.610016963, 0.622819197, 0.636654117, 0.648369466, 0.66242077, 0.673940008, 0.68687712,
             0.698369466, 0.71215722, 0.725]
        ],
        8: [
            # а)
            [0.088, 0.097260563, 0.10573, 0.113930392, 0.122424772, 0.130993646, 0.142472798, 0.154841562, 0.165958551,
             0.178774615, 0.18922481, 0.198464136, 0.209938965, 0.219402107, 0.239371315, 0.25017536, 0.26],
            # б)
            [0.27, 0.284079299, 0.293580568, 0.305666219, 0.314773107, 0.325965966, 0.334780497, 0.345655576,
             0.355596718, 0.375263917, 0.385931603, 0.395577712, 0.406032654, 0.416083179, 0.426878646, 0.437291106,
             0.447711928, 0.457505554, 0.46851109, 0.47843651, 0.49],
            # в)
            [0.5, 0.512227141, 0.523894911, 0.536894911, 0.547722383, 0.561128672, 0.571997518, 0.585461316,
             0.597057096, 0.610016963, 0.622819197, 0.636654117, 0.648369466, 0.66242077, 0.673940008, 0.68687712,
             0.698369466, 0.71215722, 0.725]
        ],
        10: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [0.5, 0.513024921, 0.525296885, 0.536727019, 0.548473559, 0.561327728, 0.573145861, 0.585403013,
             0.597823922, 0.61177461, 0.623628539, 0.637447974, 0.649051329, 0.663125864, 0.674245763, 0.687956574,
             0.698916419, 0.712939111, 0.725]
        ],
        12: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [0.5, 0.513024921, 0.525296885, 0.536727019, 0.548473559, 0.561327728, 0.573145861, 0.585403013,
             0.597823922, 0.61177461, 0.623628539, 0.637447974, 0.649051329, 0.663125864, 0.674245763, 0.687956574,
             0.698916419, 0.712939111, 0.725]
        ],
    }[_2p]

    y_temp = {
        2: [
            # а)
            [16, 17.12921877, 17.91799616, 18.85282166, 19.72375315, 20.27678256, 21.03652019, 21.7084199, 22.31462898,
             22.82401709, 23.3662995, 23.90492337, 24.4453765, 24.8908706, 25.33639737, 26],
            # б)
            [26, 35.25, 35.5596541, 35.8901174, 36.4577459, 36.8825526, 37.418265, 37.8596667, 38.3072753, 38.6059858,
             38.9942704, 39.2830174, 39.6476507, 39.9115052, 40.2189053, 40.4479037, 40.7013046, 40.9394825, 41.1983715,
             41.3775848, 41.5779665, 41.7521817, 41.9612856, 42.1205718, 42.25],
            # в)
            [42.25, 48, 48.51079411, 48.73923362, 48.93725949, 49.12709188, 49.31739632, 49.4795125, 49.64371921, 49.82030042,
             49.98501289, 50.14675818, 50.29231882, 50.56476033, 50.82283797, 51.1]
        ],
        4: [
            # а)
            [17, 17.9371433, 18.97630018, 19.92254482, 20.86875673, 21.69763338, 22.69727473, 23.56281865, 24.24224345,
             24.95375211, 25.47635887, 25.87246357, 26.36393589, 26.74534094, 27.46418305, 27.80895357, 28.1],
            # б)
            [28.1, 32.5, 32.9774737, 33.3981134, 33.8178761, 34.2716381, 34.6604034, 35.0190821, 35.4002921, 35.7840655,
             36.0830431, 36.388598, 36.618464, 36.913158, 37.171323, 37.4406187, 37.6779052, 37.9246022, 38.1673529,
             38.4163435, 38.6373725, 38.8635282, 39.0624644, 39.25],
            # в)
            [39.25, 43.25, 43.84573306, 44.13075539, 44.32551832, 44.55055437, 44.74020761, 44.91155698, 45.05546806,
             45.21652808, 45.33993042, 45.50896994, 45.61865314, 45.68605896, 45.75]
        ],
        6: [
            # а)
            [17, 17.9371433, 18.97630018, 19.92254482, 20.86875673, 21.69763338, 22.69727473, 23.56281865, 24.24224345,
             24.95375211, 25.47635887, 25.87246357, 26.36393589, 26.74534094, 27.46418305, 27.80895357, 28.1],
            # б)
            [28.1, 30.5, 31.2370465, 31.6911625, 32.1751146, 32.5375748, 32.9546849, 33.2653037, 33.5943925, 33.8783472,
             34.4366086, 34.6966086, 34.9026525, 35.1044671, 35.2873823, 35.4723791, 35.6363948, 35.7810155, 35.8995998,
             36.0257505, 36.1333982, 36.25],
            # в)
            [36.25, 39.4, 39.67124875, 39.9185797, 40.17771732, 40.36686072, 40.55444794, 40.68344164, 40.84135997,
             40.97387198, 41.09714841, 41.21639908, 41.32654948, 41.41958192, 41.50324345, 41.56038228, 41.63683802,
             41.69397685, 41.75169079, 41.8]
        ],
        8: [
            # а)
            [17, 17.9371433, 18.97630018, 19.92254482, 20.86875673, 21.69763338, 22.69727473, 23.56281865, 24.24224345,
             24.95375211, 25.47635887, 25.87246357, 26.36393589, 26.74534094, 27.46418305, 27.80895357, 28.1],
            # б)
            [30.5, 31.2370465, 31.6911625, 32.1751146, 32.5375748, 32.9546849, 33.2653037, 33.5943925, 33.8783472,
             34.4366086, 34.6966086, 34.9026525, 35.1044671, 35.2873823, 35.4723791, 35.6363948, 35.7810155, 35.8995998,
             36.0257505, 36.1333982, 36.25],
            # в)
            [39.4, 39.67124875, 39.9185797, 40.17771732, 40.36686072, 40.55444794, 40.68344164, 40.84135997,
             40.97387198, 41.09714841, 41.21639908, 41.32654948, 41.41958192, 41.50324345, 41.56038228, 41.63683802,
             41.69397685, 41.75169079, 41.8]
        ],
        10: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [36, 36.3029203, 36.55064806, 36.72862886, 36.88660993, 37.05800258, 37.21598365, 37.36983032, 37.49513956,
             37.62693611, 37.73224562, 37.86720179, 37.9637383, 38.06467812, 38.14366866, 38.24077659, 38.32252339,
             38.42144643, 38.5]
        ],
        12: [
            # а)
            [None],
            # б)
            [None],
            # в)
            [36, 36.3029203, 36.55064806, 36.72862886, 36.88660993, 37.05800258, 37.21598365, 37.36983032, 37.49513956,
             37.62693611, 37.73224562, 37.86720179, 37.9637383, 38.06467812, 38.14366866, 38.24077659, 38.32252339,
             38.42144643, 38.5]
        ],
    }[_2p]

    for i in range(len(x_temp)):
        if (x_temp[i][0] <= D_a <= x_temp[i][-1]):
            x_meow = x_temp[i]
            y_meow = y_temp[i]
            break

    if (D_a < x_temp[0][0]):
        return None
    elif (D_a > x_temp[-1][-1]):
        return None
    else:
        return LinearInterpolation(D_a, x_meow, y_meow) * 1000


#####################################################################################*
######! Рисунок 9.26
def t_z1__2_max(tau):
    x_meow = [0.039, 0.043231664, 0.047339219, 0.05016655, 0.05357881, 0.056898766, 0.060653155, 0.064054379,
              0.067099428, 0.070122404, 0.07329989, 0.075259356, 0.077488713, 0.079368917, 0.081316344, 0.083673121,
              0.085787097, 0.088786997, 0.091819003, 0.094619244, 0.098086686, 0.101669509, 0.105161031, 0.106819504,
              0.11046052, 0.114377446, 0.119252533, 0.123764423, 0.128115782, 0.132363801, 0.136355975, 0.14016354,
              0.144886124, 0.149795325, 0.153938999, 0.15774255, 0.161353466, 0.166627872, 0.170300993, 0.174328283,
              0.177461623, 0.180945119, 0.183853717, 0.186345942, 0.191564162, 0.196524531, 0.201507976, 0.206261663,
              0.210202669, 0.213106251, 0.215819203, 0.219804354, 0.221953446, 0.224726598, 0.227295074, 0.229810374,
              0.234302197, 0.238253236, 0.242550416, 0.246174375, 0.251085582, 0.256902779, 0.262641718, 0.26460921,
              0.270366208, 0.275217217, 0.279425103, 0.284832949, 0.289173272, 0.293568777, 0.297209792, 0.300325073,
              0.304296177, 0.308747868, 0.313065115, 0.315144978, 0.319203371, 0.322496238, 0.325832246, 0.3298485,
              0.33373934, 0.337400421, 0.340964182, 0.345316545, 0.349494331, 0.354803853, 0.36, 0.4]
    y_meow = [0.01, 0.010198106, 0.010429037, 0.010576698, 0.010754878, 0.010928548, 0.011124557, 0.011287949,
              0.011434247, 0.01158086, 0.011735024, 0.011833395, 0.01194519, 0.012045764, 0.012150008, 0.012274178,
              0.012385658, 0.012542653, 0.012701956, 0.012833887, 0.01300525, 0.013152282, 0.013326267, 0.013414465,
              0.013598098, 0.013780054, 0.0139984, 0.014207832, 0.014366925, 0.014572267, 0.014724752, 0.014885209,
              0.015040211, 0.015242617, 0.015367731, 0.015518119, 0.015636941, 0.015810611, 0.015918211, 0.016036088,
              0.016138759, 0.016252966, 0.016338019, 0.016410906, 0.016540634, 0.01666386, 0.016816031, 0.016961176,
              0.017072866, 0.017155192, 0.017239719, 0.017345432, 0.017393464, 0.017455444, 0.017532735, 0.017608454,
              0.017742272, 0.01782659, 0.017941846, 0.017981279, 0.018069267, 0.018122019, 0.018194696, 0.018204973,
              0.018273036, 0.018316034, 0.018372456, 0.018424054, 0.018481629, 0.018500821, 0.018538156, 0.018570142,
              0.018581678, 0.018616391, 0.018650056, 0.018662326, 0.018686342, 0.01870459, 0.01871728, 0.018718328,
              0.018713609, 0.018727452, 0.018740981, 0.018741505, 0.018742135, 0.018743183, 0.01875, 0.0188]
    if (tau < x_meow[0]):
        return None
    return LinearInterpolation(tau, x_meow, y_meow)


def t_z1__2_min(tau):
    x_meow = [0.039, 0.040851783, 0.042009682, 0.045553499, 0.049336157, 0.051679006, 0.07027052, 0.072623336,
              0.078592582, 0.081544458, 0.083939631, 0.089005482, 0.092304051, 0.093788353, 0.105205382, 0.114267459,
              0.126414537, 0.13374386, 0.142036378, 0.145126717, 0.146647683, 0.149720225, 0.153146935, 0.154994661,
              0.164940913, 0.166513134, 0.176522033, 0.185347761, 0.193910088, 0.199642272, 0.204753684, 0.207321136,
              0.211839895, 0.214403075, 0.223786218, 0.227043853, 0.229010109, 0.229977931, 0.233566954, 0.242766071,
              0.248709333, 0.24938243, 0.252696305, 0.260360575, 0.261374315, 0.262708407, 0.263727486, 0.265062291,
              0.266082793, 0.267750053, 0.27416459, 0.275871004, 0.277217911, 0.278931444, 0.280618993, 0.281658005,
              0.284031466, 0.288829287, 0.291592511, 0.293641347, 0.295730405, 0.298468712, 0.299161743, 0.300222111,
              0.30333096, 0.304381363, 0.306111269, 0.309963337, 0.313776963, 0.315183313, 0.316981206, 0.317685627,
              0.322541468, 0.323939987, 0.325002848, 0.328230939, 0.329646188, 0.331041859, 0.334505944, 0.336255072,
              0.347300847, 0.349093045, 0.350848936, 0.355004627, 0.356400655, 0.358175767, 0.36, 0.4]
    y_meow = [0.0078, 0.007848937, 0.007909175, 0.008074055, 0.00826547, 0.008379846, 0.009248681, 0.00936079,
              0.009621411, 0.009759055, 0.009861663, 0.010084981, 0.010224825, 0.010291764, 0.010769868, 0.011136331,
              0.011610402, 0.01188559, 0.01218448, 0.012290889, 0.01234956, 0.012460002, 0.012570811, 0.012636116,
              0.012963775, 0.013010846, 0.013324171, 0.013583058, 0.013820977, 0.013974222, 0.014106699, 0.014170304,
              0.014275813, 0.014340384, 0.014553735, 0.014622273, 0.014660776, 0.014683512, 0.014757651, 0.014932098,
              0.015037573, 0.01504644, 0.015102245, 0.015221154, 0.015233522, 0.015253923, 0.015265091, 0.015285293,
              0.01529616, 0.015321729, 0.015401102, 0.01541787, 0.015435404, 0.015450506, 0.015471541, 0.015478175,
              0.01550511, 0.015547513, 0.015566882, 0.015586716, 0.015597451, 0.015622419, 0.01562672, 0.01562852,
              0.015650255, 0.015654288, 0.015665656, 0.015680391, 0.015703792, 0.015707826, 0.015703892, 0.015705693,
              0.015734928, 0.015740795, 0.015742029, 0.015736728, 0.015738828, 0.015745296, 0.015767197, 0.015774331,
              0.015772731, 0.015770098, 0.015775631, 0.015802167, 0.015808634, 0.015809867, 0.0158, 0.0162]
    if (tau < x_meow[0]):
        return None
    return LinearInterpolation(tau, x_meow, y_meow)


def t_z1__1_max(tau):
    x_meow = [0.039, 0.046678929, 0.054961139, 0.059657883, 0.067889555, 0.079647735, 0.08876643, 0.099306993,
              0.109769646, 0.118825697, 0.14, 0.142, 0.144, 0.146, 0.148, 0.15]
    y_meow = [0.0079, 0.008266383, 0.00864955, 0.008868496, 0.009237922, 0.009757115, 0.010159918, 0.010571802,
              0.010985873, 0.01131907, 0.0121, 0.01215, 0.0122, 0.0123, 0.0124, 0.0125]
    if (tau < x_meow[0]):
        return None
    return LinearInterpolation(tau, x_meow, y_meow)


def t_z1__1_min(tau):
    x_meow = [0.06, 0.071538641, 0.07956885, 0.085500144, 0.090619146, 0.100394138, 0.112058908, 0.123684869,
              0.133199518, 0.140882603, 0.15]
    y_meow = [0.006, 0.006846631, 0.007428613, 0.007857488, 0.00823164, 0.008923941, 0.009683016, 0.010426721,
              0.011000087, 0.011462203, 0.012]
    if (tau < x_meow[0]):
        return None
    return LinearInterpolation(tau, x_meow, y_meow)


def t_z1__3_max(tau):
    x_meow = [0.1, 0.102711728, 0.108182185, 0.111535202, 0.113606685, 0.118470667, 0.120693595, 0.122127967,
              0.123687672, 0.127014926,
              0.127952838, 0.129433862, 0.136074793, 0.141869376, 0.14478303, 0.148805189, 0.152957555, 0.156679262,
              0.160920058, 0.164938736, 0.171]
    y_meow = [0.0149, 0.015013642, 0.0153208, 0.015449454, 0.015547702, 0.015830718, 0.015981375, 0.016063579,
              0.016112665, 0.016155639, 0.016184555,
              0.016254421, 0.016621246, 0.016842609, 0.016995214, 0.017131393, 0.017325559, 0.01744898, 0.017619729,
              0.017756863, 0.018]
    if (tau < x_meow[0]):
        return None
    elif (tau > x_meow[-1]):
        return t_z1__2_max(tau) + 0.0015
    return LinearInterpolation(tau, x_meow, y_meow)


def t_z1__3_min(tau):
    x_meow = [0.1, 0.102583376, 0.109645092, 0.115964205, 0.118307739, 0.122488549, 0.12842797, 0.132558084,
              0.136551845,
              0.141849007, 0.145472865, 0.152643664, 0.155079148, 0.159550496, 0.16459348, 0.169440325, 0.171]
    y_meow = [0.013, 0.013145552, 0.013489821, 0.013755538, 0.013872943, 0.014058121, 0.014241974, 0.01444014,
              0.014583705,
              0.014841658, 0.014990227, 0.01521768, 0.015311685, 0.015512168, 0.015656543, 0.015850771, 0.0159]
    if (tau < x_meow[0]):
        return None
    elif (tau > x_meow[-1]):
        return t_z1__2_max(tau)
    return LinearInterpolation(tau, x_meow, y_meow)


#####################################################################################TODO
######! Рисунок 9.27
def AJ__up(_2p, D_a):
    x_temp = {
        2: [
            # а)
            [0.09, 0.091384329, 0.092691798, 0.097384937, 0.102765116, 0.105031623, 0.111409697, 0.115582325,
             0.119547005, 0.126901625, 0.137179475, 0.139431891, 0.143322273, 0.14824471, 0.152894295, 0.157854735,
             0.162532502, 0.167697047, 0.173886815, 0.176684082, 0.185773168, 0.191062397, 0.202326187, 0.208694013,
             0.213172799, 0.228439698, 0.249900635, 0.26],
            # б)
            [0.26625, 0.26803431, 0.271833611, 0.276149534, 0.283380362, 0.298857157, 0.30292688, 0.305874001,
             0.32173691, 0.327731561, 0.337840142, 0.344007157, 0.349139752, 0.356395272, 0.360429251, 0.363305592,
             0.367198247, 0.369853549, 0.371890409, 0.384435602, 0.394573812, 0.398521727, 0.407924391, 0.414342545,
             0.416808316, 0.423192609, 0.428934475, 0.435123124, 0.439034591, 0.441759496, 0.445913872, 0.453595951,
             0.459658325, 0.474343609, 0.479969781, 0.484334145, 0.491871608, 0.496468299, 0.5],
            # в)
            [0.5, 0.504949082, 0.512466382, 0.519351883, 0.525193505, 0.535664664, 0.579390903,
             0.603162635, 0.665209642, 0.680498145, 0.687479829, 0.7]
        ],
        4: [
            # а)
            [0.08, 0.085564689, 0.102926833, 0.126518964, 0.132079483, 0.142362876, 0.154940064, 0.15894436,
             0.163808077, 0.1768254, 0.18032331, 0.189152869, 0.193885936, 0.199993148, 0.20715483, 0.212496208,
             0.223322125, 0.230505582, 0.236506698, 0.244916972, 0.259795368, 0.27],
            # б)
            [0.26625, 0.26803431, 0.271833611, 0.276149534, 0.283380362, 0.298857157, 0.30292688, 0.305874001,
             0.32173691, 0.327731561, 0.337840142, 0.344007157, 0.349139752, 0.356395272, 0.360429251, 0.363305592,
             0.367198247, 0.369853549, 0.371890409, 0.384435602, 0.394573812, 0.398521727, 0.407924391, 0.414342545,
             0.416808316, 0.423192609, 0.428934475, 0.435123124, 0.439034591, 0.441759496, 0.445913872, 0.453595951,
             0.459658325, 0.474343609, 0.479969781, 0.484334145, 0.491871608, 0.496468299, 0.5],
            # в)
            [0.5, 0.504949082, 0.512466382, 0.519351883, 0.525193505, 0.535664664, 0.579390903,
             0.603162635, 0.665209642, 0.680498145, 0.687479829, 0.7]
        ],
        6: [
            # а)
            [0.08, 0.085564689, 0.102926833, 0.126518964, 0.132079483, 0.142362876, 0.154940064, 0.15894436,
             0.163808077, 0.1768254, 0.18032331, 0.189152869, 0.193885936, 0.199993148, 0.20715483, 0.212496208,
             0.223322125, 0.230505582, 0.236506698, 0.244916972, 0.259795368, 0.27],
            # б)
            [0.26, 0.262331788, 0.272767181, 0.291910484, 0.304916138, 0.330662505, 0.347541893, 0.371915864,
             0.393489489, 0.417439713, 0.445087045, 0.467095948, 0.492810082, 0.511747407, 0.535153076, 0.54894333,
             0.562611989, 0.577444446, 0.6],
            # в)
            [0.5, 0.504052629, 0.519977544, 0.528787924, 0.540472086, 0.557899256, 0.575750046, 0.586705855,
             0.591153863, 0.647847852, 0.661515283, 0.670795745, 0.7]
        ],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    y_temp = {
        2: [
            # а)
            [119.5, 119.9116437, 120.4208523, 122.5933421, 124.9783363, 125.8958474, 128.101527, 129.3132921,
             130.2477322, 132.3017185, 134.4459189, 134.8424156, 135.3315766, 136.1374895, 136.7482725, 137.5060711,
             138.081214, 138.5826264, 139.4090323, 139.6582906, 140.0663703, 140.4105205, 140.9903411, 141.3765912,
             141.6632717, 142.2900928, 142.7961829, 143],
            # б)
            [180, 180.3385155, 180.845346, 181.6541708, 182.4332229, 183.4361656, 183.8419674, 184.1935829, 185.5219412,
             185.8833817, 186.3658978, 186.7914488, 187.0726022, 187.5869751, 187.7896279, 187.9738216, 188.0808048,
             188.2506084, 188.3316894, 188.7276662, 189.1800126, 189.2307254, 189.4740676, 189.6434742, 189.7668324,
             189.9707753, 190.1105085, 190.274159, 190.3620877, 190.4609331, 190.5410216, 190.8600856, 190.9128825,
             191.2115026, 191.3028055, 191.4083994, 191.3957956, 191.5042674, 191.5],
            # в)
            [183, 183.7866219, 184.1424005, 184.7613305, 184.8938977, 185.6077209, 187.0702088, 187.675259, 187.6826238,
             187.3523389, 186.8775898, 186.5]
        ],
        4: [
            # а)
            [145, 147.6971963, 156.7764058, 167.1541493, 169.3240472, 173.0180481, 176.7413931, 178.021783, 179.3812452,
             182.5909558, 183.3794394, 184.9814948, 185.9523152, 186.9430717, 187.7857636, 188.5876873, 190.0246538,
             190.8420336, 191.4152522, 192.4243768, 193.6904306, 194],
            # б)
            [180, 180.3385155, 180.845346, 181.6541708, 182.4332229, 183.4361656, 183.8419674, 184.1935829, 185.5219412,
             185.8833817, 186.3658978, 186.7914488, 187.0726022, 187.5869751, 187.7896279, 187.9738216, 188.0808048,
             188.2506084, 188.3316894, 188.7276662, 189.1800126, 189.2307254, 189.4740676, 189.6434742, 189.7668324,
             189.9707753, 190.1105085, 190.274159, 190.3620877, 190.4609331, 190.5410216, 190.8600856, 190.9128825,
             191.2115026, 191.3028055, 191.4083994, 191.3957956, 191.5042674, 191.5],
            # в)
            [183, 183.7866219, 184.1424005, 184.7613305, 184.8938977, 185.6077209, 187.0702088, 187.675259, 187.6826238,
             187.3523389, 186.8775898, 186.5]
        ],
        6: [
            # а)
            [145, 147.6971963, 156.7764058, 167.1541493, 169.3240472, 173.0180481, 176.7413931, 178.021783, 179.3812452,
             182.5909558, 183.3794394, 184.9814948, 185.9523152, 186.9430717, 187.7857636, 188.5876873, 190.0246538,
             190.8420336, 191.4152522, 192.4243768, 193.6904306, 194],
            # б)
            [195, 195.2196303, 195.9125319, 197.0691736, 197.7968403, 199.0883595, 199.853397, 200.852533, 201.633273,
             202.4032475, 203.1564223, 203.6621959, 204.1459585, 204.439096, 204.7248965, 204.791341, 204.9347212,
             205.0051428, 205],
            # в)
            [167, 167.0597004, 168.1901483, 168.5574304, 169.3060684, 169.7257869, 170.184322, 170.1643462, 170.3550242,
             170.4760139, 170.6412682, 170.9919794, 171.5]
        ],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    for i in range(len(x_temp)):
        if (x_temp[i][0] <= D_a <= x_temp[i][-1]):
            x_meow = x_temp[i]
            y_meow = y_temp[i]
            break

    if (D_a < x_temp[0][0]):
        return None
    elif (D_a > x_temp[-1][-1]):
        return None
    else:
        return LinearInterpolation(D_a, x_meow, y_meow) * 10 ** 9


def AJ__down(_2p, D_a):
    x_temp = {
        2: [
            # а)
            [0.09, 0.092062512, 0.09557099, 0.105751589, 0.120519299, 0.123814906, 0.128352693, 0.135016161,
             0.141554157, 0.148016869, 0.15469548, 0.160880422, 0.176164733, 0.19238187, 0.200374917, 0.204873764,
             0.209485104, 0.217335371, 0.232042508, 0.240997801, 0.250222644, 0.26],
            # б)
            [0.26625, 0.295, 0.298839423, 0.310834711, 0.321559088, 0.332482223, 0.3502074, 0.386258002, 0.394143557,
             0.414922215, 0.424483577, 0.439275665, 0.471754882, 0.5],
            # в)
            [0.5, 0.503533041, 0.530657544, 0.571697513, 0.582177611, 0.603110093, 0.621835164, 0.631176802,
             0.670328727, 0.7]
        ],
        4: [
            # а)
            [0.08, 0.086338113, 0.093104819, 0.107096141, 0.110747949, 0.117539456, 0.122838274, 0.131893158,
             0.144242522, 0.153752102, 0.15788157, 0.164911448, 0.172086462, 0.180982891, 0.193224781, 0.197995417,
             0.204946757, 0.21120457, 0.216017001, 0.220750893, 0.22853125, 0.233340007, 0.239849051, 0.253814654,
             0.263937384, 0.27],
            # б)
            [0.26625, 0.295, 0.298839423, 0.310834711, 0.321559088, 0.332482223, 0.3502074, 0.386258002, 0.394143557,
             0.414922215, 0.424483577, 0.439275665, 0.471754882, 0.5],
            # в)
            [0.5, 0.503533041, 0.530657544, 0.571697513, 0.582177611, 0.603110093, 0.621835164, 0.631176802,
             0.670328727, 0.7]
        ],
        6: [
            # а)
            [0.08, 0.086338113, 0.093104819, 0.107096141, 0.110747949, 0.117539456, 0.122838274, 0.131893158,
             0.144242522, 0.153752102, 0.15788157, 0.164911448, 0.172086462, 0.180982891, 0.193224781, 0.197995417,
             0.204946757, 0.21120457, 0.216017001, 0.220750893, 0.22853125, 0.233340007, 0.239849051, 0.253814654,
             0.263937384, 0.27],
            # б)
            [0.26, 0.263280459, 0.271796747, 0.287539907, 0.308271556, 0.322358356, 0.344058642, 0.362389291,
             0.376736806, 0.399355631, 0.410249576, 0.433640583, 0.4530558, 0.487267835, 0.501548991, 0.520208814,
             0.545138936, 0.558030481, 0.57783992, 0.585948085, 0.6],
            # в)
            [0.5, 0.516566874, 0.523340897, 0.553343267, 0.584376823, 0.605468066, 0.647268701, 0.7]

        ],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    y_temp = {
        2: [
            # а)
            [115, 115.9836577, 117.2572163, 120.5475012, 124.0144615, 124.6236181, 125.2903904, 126.4355904,
             127.2682807, 128.1777311, 128.8676589, 129.6195782, 130.7996027, 131.9110721, 132.1440868, 132.4101029,
             132.5612525, 132.9395824, 133.3859205, 133.6364387, 133.8213189, 134],
            # б)
            [180, 180, 180.1583699, 181.3595564, 182.0815063, 182.5862781, 183.7456796, 185.4054681, 185.4957441,
             186.4271344, 186.552489, 187.1833892, 187.7665721, 188],
            # в)
            [180, 180.259754, 181.6640873, 182.721186, 182.6996823, 182.9848497, 183.1886454, 183.4635497, 183.4608618,
             183]
        ],
        4: [
            # а)
            [140, 141.5787649, 145.1699867, 152.0399734, 153.704077, 156.5498274, 158.9858167, 162.4169721, 166.8457769,
             169.7373572, 170.8347942, 172.8522178, 174.6973838, 176.6811687, 179.6016467, 180.4832537, 181.5032537,
             182.8016202, 183.6335591, 184.5589641, 185.6859761, 186.522656, 187.5223373, 189.4878353, 190.6970252,
             191],
            # б)
            [180, 180, 180.1583699, 181.3595564, 182.0815063, 182.5862781, 183.7456796, 185.4054681, 185.4957441,
             186.4271344, 186.552489, 187.1833892, 187.7665721, 188],
            # в)
            [180, 180.259754, 181.6640873, 182.721186, 182.6996823, 182.9848497, 183.1886454, 183.4635497, 183.4608618,
             183]
        ],
        6: [
            # а)
            [140, 141.5787649, 145.1699867, 152.0399734, 153.704077, 156.5498274, 158.9858167, 162.4169721, 166.8457769,
             169.7373572, 170.8347942, 172.8522178, 174.6973838, 176.6811687, 179.6016467, 180.4832537, 181.5032537,
             182.8016202, 183.6335591, 184.5589641, 185.6859761, 186.522656, 187.5223373, 189.4878353, 190.6970252,
             191],
            # б)
            [191, 191.2853034, 191.8951003, 192.9307859, 194.13734, 194.8823781, 195.9291082, 196.7154739,
             197.2893584, 198.0724465, 198.4731824, 199.1738288, 199.6946287, 200.4948178,
             200.7679367, 201.0571591, 201.4286094, 201.5937775, 201.8085389, 201.8745207, 202],
            # в)
            [162.5, 163.7631839, 163.8791402, 165.5568063, 166.2824585, 166.8767347, 167.1715599, 167.5]
        ],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    for i in range(len(x_temp)):
        if (x_temp[i][0] <= D_a <= x_temp[i][-1]):
            x_meow = x_temp[i]
            y_meow = y_temp[i]
            break

    if (D_a < x_temp[0][0]):
        return None
    elif (D_a > x_temp[-1][-1]):
        return None
    else:
        return LinearInterpolation(D_a, x_meow, y_meow) * 10 ** 9


#####################################################################################TODO
######! Рисунок 9.31
def delta(h):
    def delta_4(D):
        if (h <= 250):
            x_meow = [0.04, 0.063013004, 0.06801365, 0.078441723, 0.084634295, 0.101055152, 0.109868769, 0.124008644,
                      0.132644578, 0.150313471, 0.164656535, 0.181390251, 0.192339473, 0.198893363, 0.20654226,
                      0.224577572, 0.241129354, 0.258039903, 0.280411886, 0.286221035, 0.29, 0.3, 0.31]
            y_meow = [0.23, 0.229580806, 0.230868331, 0.239141002, 0.246066262, 0.274036786, 0.291035542, 0.315695287,
                      0.334845621,
                      0.378664256, 0.421537564, 0.476721496, 0.519462203, 0.543232229, 0.574372375, 0.655088661,
                      0.733161456,
                      0.81768471, 0.939807124, 0.977243739, 0.988, 1, 1.05]
        elif (h >= 280):
            x_meow = [0.28, 0.3196, 0.336, 0.342468045, 0.350421369, 0.35772158, 0.366833628, 0.403150513, 0.419215752,
                      0.442981084, 0.456023752, 0.476]
            y_meow = [0.8, 0.876, 0.91, 0.927622777, 0.94910677, 0.964036254, 0.987378121, 1.092358331, 1.14437046,
                      1.226303902, 1.273706677, 1.35]
        return LinearInterpolation(D, x_meow, y_meow)
    def delta_6(D):
        if (h <= 250):
            x_meow = [0.04, 0.064015402, 0.076548904, 0.088437904, 0.094186139, 0.12802505, 0.139705787, 0.162551316,
                      0.181989213, 0.203113786, 0.21269732, 0.242815777, 0.255604679, 0.274598625, 0.284937221,
                      0.291963318, 0.32]
            y_meow = [0.245, 0.245243761, 0.248709228, 0.250037725, 0.252942542, 0.28766628, 0.301186883, 0.334143355,
                      0.36684794, 0.409676727, 0.427576901, 0.495062101, 0.525345328, 0.572943703, 0.601829367,
                      0.619554846, 0.7]
        elif (h >= 280):
            x_meow = [0.366, 0.384545687, 0.395604143, 0.407266175, 0.428723326, 0.442734109, 0.460444665,
                      0.474064699, 0.492]
            y_meow = [0.8, 0.83380191, 0.852826488, 0.87677255, 0.92665302, 0.963486837, 1.007127417, 1.048719527, 1.1]
        return LinearInterpolation(D, x_meow, y_meow)

    def delta_2(D):
        if (h <= 250):
            x_meow = [0.04, 0.043101135, 0.046781906, 0.065184899, 0.072619539, 0.085902133, 0.092360681, 0.101136051,
                      0.112590299, 0.133323013, 0.140912453, 0.15004644, 0.157847437, 0.186772446, 0.200970932,
                      0.209657723, 0.228073615, 0.234147747, 0.2375]
            y_meow = [0.245, 0.24900534, 0.256315087, 0.302948097, 0.32679239, 0.3728997, 0.398091622, 0.436480307,
                      0.483830941, 0.583868491, 0.62709279, 0.675565754, 0.722540888, 0.889968291, 0.978386182,
                      1.036113151, 1.153649032, 1.196168224, 1.22]
        elif (h >= 280):
            x_meow = [0.27, 0.273229017, 0.276293421, 0.299656362, 0.315097943, 0.325149743, 0.329425353,
                      0.33903703, 0.344589692, 0.351123102, 0.359553895, 0.371277818, 0.374]
            y_meow = [1.3, 1.313616851, 1.328942281, 1.458172931, 1.551579527, 1.617234669, 1.642971208, 1.7095281,
                      1.745589457, 1.79258399, 1.861578625, 1.94538094, 1.97]
        return LinearInterpolation(D, x_meow, y_meow)

    return {
        2: delta_2,
        4: delta_4,
        6: delta_6,
        8: 0,
        10: 0,
        12: 0
    }


#####################################################################################*
######! Рисунок 9.51
def k_sk_shtrih_func(x):
    x_meow = [0.5, 0.541676047, 0.571944458, 0.589960637, 0.6325484, 0.690056423, 0.725823096, 0.775539583, 0.840246247,
              0.878432044, 0.914685339, 1.1280912, 1.175749334, 1.302886168, 1.368359121, 1.395623903, 1.446562537,
              1.505933145, 1.583434596, 1.627722738, 1.71]
    y_meow = [0.5, 0.535419532, 0.573292307, 0.591287179, 0.616270481, 0.662643413, 0.701669875, 0.741120683,
              0.801191996, 0.844541472, 0.877971887, 1.093658402, 1.156686869, 1.30288692, 1.386230895, 1.426437566,
              1.483962811, 1.573088484, 1.678882952, 1.748462241, 1.85]
    if (x < x_meow[0]):
        return None
    elif (x > x_meow[-1]):
        return None
    else:
        return LinearInterpolation(x, x_meow, y_meow)


#####################################################################################*
######! Рисунок 9.53
def beta_0_func(x):
    x_meow = [0, 0.593208175, 1.015249632, 1.393773369, 1.82787826, 2.041177637, 2.352458902, 2.596765771, 2.861625157,
              3.179653009, 3.616438662, 4.377507281, 5.008826971, 5.602615978, 6.309979978, 7.939794531, 8.905718123,
              9.937409769, 11.01230638, 12.00079306, 12.87445372, 13.95082475, 14.84030192, 16]
    y_meow = [0, 0.022940297, 0.041804426, 0.063053268, 0.091335185, 0.114610118, 0.154460405, 0.181577376, 0.20390779,
              0.224531901, 0.248339055, 0.281052334, 0.304560257, 0.323407255, 0.340433738, 0.370299753, 0.385287582,
              0.398305281, 0.40880921, 0.417264205, 0.423521791, 0.429833057, 0.433676236, 0.4375]
    if (x < x_meow[0]):
        return None
    elif (x > x_meow[-1]):
        return None
    else:
        return LinearInterpolation(x, x_meow, y_meow)


#####################################################################################*
######! Рисунок 9.57
def phi_func(Ksi):
    x_meow = [1, 1.045716464, 1.071829191, 1.093772285, 1.133323188, 1.164950981, 1.197944409, 1.240456882, 1.282193609,
              1.31498098, 1.352115758, 1.396537293, 1.43851038, 1.484267247, 1.49921651, 1.526028216, 1.56535488,
              1.583970753, 1.606806763, 1.622547934, 1.675094594, 1.694179147, 1.713508141, 1.847704042, 1.958722525,
              2.02682046, 2.129329983, 2.212908487, 2.278586258, 2.341575181, 2.413380129, 2.470326722, 2.594393488,
              2.62838286, 2.648047202, 2.676961906, 2.694228305, 2.722615744, 2.755641495, 2.798953956, 2.88632432,
              2.909190632, 2.931782201, 2.96015954, 3.099355364, 3.128668041, 3.327188198, 3.357868531, 3.472084944,
              3.504207679, 3.611274708, 3.644827723, 3.751898792, 3.784017487, 3.983955804, 4]
    y_meow = [0.1, 0.106742245, 0.112019138, 0.117608586, 0.12950595, 0.141009576, 0.154108448, 0.173525384,
              0.194821706, 0.213317216, 0.235971323, 0.265456977, 0.295983803, 0.332035129, 0.344788973, 0.367974829,
              0.404921198, 0.423577044, 0.448585457, 0.464365396, 0.521672453, 0.544180431, 0.564559386, 0.717814563,
              0.84214019, 0.921397091, 1.043175602, 1.144410763, 1.22264273, 1.29590427, 1.377677844, 1.441274552,
              1.57641172, 1.613021179, 1.633258064, 1.665887528, 1.683063814, 1.713880869, 1.746831006, 1.792579638,
              1.880056315, 1.905135764, 1.926923243, 1.956577351, 2.096380511, 2.123530125, 2.323276758, 2.351788216,
              2.466842748, 2.496754613, 2.604648806, 2.635991521, 2.743875567, 2.773797579, 2.975001447, 2.99]
    if (Ksi < x_meow[0]):
        return 0.89 * Ksi ** 4
    elif (Ksi > 4):
        return Ksi - 1
    else:
        return LinearInterpolation(Ksi, x_meow, y_meow)


#####################################################################################*
######! Рисунок 9.58
def phi_shtrih_func(Ksi):
    x_meow = [0, 0.494470351, 0.583413212, 0.669402706, 0.912371906, 0.98345783, 1.241303253, 1.328796776, 1.392854778,
              1.464077432, 1.52355498, 1.657468336, 1.707702936, 2.023877375, 2.113654289, 2.408211716, 2.503430484,
              2.756271589, 2.88915947, 2.974875504, 3.412944732, 3.8]
    y_meow = [1, 0.984335316, 0.980155786, 0.974184053, 0.95550614, 0.948809316, 0.914302548, 0.900973885, 0.890032547,
              0.875147677, 0.861449629, 0.827117292, 0.811767269, 0.704067434, 0.675689729, 0.592991825, 0.570124121,
              0.523995388, 0.496732681, 0.482330064, 0.424329689, 0.38]
    if (Ksi < x_meow[0]):
        return None
    elif (Ksi > x_meow[-1]):
        return None
    else:
        return LinearInterpolation(Ksi, x_meow, y_meow)


#####################################################################################*
######! Рисунок 9.61
def k_del_func(Ksi):
    x_meow = [0, 0.231547632, 0.331592357, 0.420891382, 0.529311555, 0.71051437, 0.791923723, 0.878182461, 0.982540541,
              1.078330539, 1.239951556, 1.373699084, 1.468542655, 1.614191694, 1.762571128, 1.888345229, 2.051381698,
              2.143318989, 2.366482798, 2.487784409, 2.921188711, 3.197871631, 3.836683792, 3.976545396, 4.214366238,
              4.363985239, 4.455889029, 4.512347923, 4.702269579, 4.81795964, 4.990979643, 5.186169455, 5.371668875,
              5.540308518, 5.717541371, 5.870242536, 6.017633668, 6.166507254, 6.344284511, 6.523318084, 6.85347824,
              7.016950231, 7.167725044, 7.428461112, 7.640569329, 7.995035034, 8.324608908, 8.664995486, 8.963446195,
              9.319076088, 9.5689492, 9.89210748, 9.954965217, 10]
    y_meow = [1, 0.999448113, 0.997406372, 0.994819152, 0.990843003, 0.982401297, 0.977991008, 0.972766105, 0.965919985,
              0.959028208, 0.946063272, 0.934398354, 0.92534789, 0.91029075, 0.893739752, 0.878696229, 0.85791917,
              0.845540564, 0.813528723, 0.796705385, 0.739378037, 0.702276662, 0.613836192, 0.595345178, 0.565515253,
              0.548212919, 0.538235701, 0.532462116, 0.514350775, 0.504318289, 0.490117415, 0.475234091, 0.461982399,
              0.450637079, 0.439344624, 0.430122747, 0.42160815, 0.413435579, 0.404202487, 0.395257755, 0.380593905,
              0.373859123, 0.368061507, 0.358640983, 0.351532135, 0.340548065, 0.331552069, 0.323119173, 0.316606268,
              0.309758545, 0.305567729, 0.300754539, 0.300060876, 0.3]
    if (Ksi < x_meow[0]):
        return None
    elif (Ksi > x_meow[-1]):
        return None
    else:
        return LinearInterpolation(Ksi, x_meow, y_meow)


#######################################################################################
####### Рисунок 9.20
# def K_e_func(D_a):
#     x_meow = [0.08, 0.104, 0.119, 0.135, 0.153, 0.171, 0.194, 0.229, 0.2785, 0.32, 0.354, 0.399, 0.444, 0.525, 0.59,
#               0.66]
#     y_meow = [0.948, 0.952, 0.956, 0.96, 0.963, 0.965, 0.968, 0.972, 0.975, 0.976, 0.978, 0.98, 0.981, 0.983, 0.985,
#               0.986]
#     if (D_a < x_meow[0]):
#         return None
#     elif (D_a > x_meow[-1]):
#         return None
#     else:
#         return LinearInterpolation(D_a, x_meow, y_meow)


def K_e_func(_2p, D_a):
    x_temp = {
        2: [
            0, 0.08, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8
        ],
        4:
            [0.08, 0.104, 0.119, 0.135, 0.153, 0.171, 0.194, 0.229, 0.2785, 0.32, 0.354, 0.399, 0.444, 0.525, 0.59,
             0.66],

        6: [
            0, 0.08, 0.1, 0.125, 0.15, 0.175, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8

        ],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    y_temp = {
        2: [
            0.9718, 0.973, 0.9742, 0.9784, 0.9809, 0.9826, 0.984, 0.9846, 0.9855, 0.9861, 0.9866, 0.98696, 0.98725,
            0.98754, 0.98783, 0.9884, 0.99
        ],
        4:
            [0.948, 0.952, 0.956, 0.96, 0.963, 0.965, 0.968, 0.972, 0.975, 0.976, 0.978, 0.98, 0.981, 0.983, 0.985,
             0.986],

        6: [
            0.913, 0.92, 0.926, 0.936, 0.945, 0.9507, 0.955, 0.9613, 0.966, 0.9706, 0.973, 0.9751, 0.9769,
            0.9784, 0.98, 0.9806, 0.9815, 0.9827, 0.9836
        ],
        8: 0,
        10: 0,
        12: 0,
    }[_2p]

    if (D_a < x_temp[0]):
        return None
    elif (D_a > x_temp[-1]):
        return None
    else:
        return LinearInterpolation(D_a, x_temp, y_temp)


def spinter(x, xmeow, ymeow):
    tck = interpolate.splrep(xmeow, ymeow)
    return interpolate.splev(x, tck)
